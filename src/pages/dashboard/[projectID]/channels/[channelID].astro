---
import Layout from "@/layouts/layout.astro";
import EventFeed from "@/components/event-feed";
import { getChannel } from "@/lib/beaver/channel";

const { projectID, channelID } = Astro.params;

const url = new URL(Astro.request.url);
const searchParams = url.searchParams;

const search = searchParams.get("search");
const startDate = searchParams.get("startDate");
const endDate = searchParams.get("endDate");
const tags = searchParams.get("tags");
const sortBy = searchParams.get("sortBy");
const sortOrder = searchParams.get("sortOrder");

const channel = await getChannel(parseInt(channelID!));

---

<Layout projectID={projectID!}>
  <EventFeed
    client:load
    type="channel"
    projectID={parseInt(projectID!)}
    channel={channel}
    search={search}
    startDate={startDate}
    endDate={endDate}
    tags={tags}
    sortBy={sortBy}
    sortOrder={sortOrder}
  />
</Layout>
